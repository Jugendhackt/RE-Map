<!DOCTYPE html>
<html>
<head>
	<title>Map</title>
	<link rel="stylesheet" href="leaflet/leaflet.css" />
	<link rel="stylesheet" href="style.css" />
	<script src="leaflet/leaflet-src.js"></script>
	<script src="jQuery/jquery.js"></script>
	<meta charset="utf-8">
</head>
<body>

	
<div id="map"></div>

	<script type="text/javascript">
		city = "Berlin";
		init = true;
		gotCoords = false;
		map = {};
		OpenStreetMap = {};

		$.getJSON("Json_Parser.php",function(json2){
			if(!json2) return;
			json2.forEach(function(item, index){
				var name = item["name"];
				var gueter = item["gueter"];
				var transport = item["transport"];
				var time = item["time"];
				var streetDisplay = item["streetDisplay"]
				var street = item["street"];
				$.getJSON("http://nominatim.openstreetmap.org/search?street="+street+"&city="+city+"&format=json",function(json){
					/*if(json.length==0){
						console.log(street);
						return;
					}*/
					console.log(street);
					var latitude = json[0]["lat"];
					var longitude = json[0]["lon"];
					if(init){
						map = L.map('map').setView([latitude, longitude], 13);
						OpenStreetMap = L.tileLayer('http://{s}.tile.openstreetmap.se/hydda/full/{z}/{x}/{y}.png', { maxZoom: 25, minZoom: 5, attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>' }).addTo(map);
						init = false;
					};
					L.marker([latitude, longitude])
					.bindPopup("<b>"+name+"</b><br><br>"+streetDisplay+"<br><br>Güter: "+gueter+"<br><br>Transport: "+transport+"<br><br>Öffnungszeiten: "+time)
					.openPopup()
					.addTo(map);
					gotCoords = true;
				});
			});
		});
	</script>

</body>
</html>